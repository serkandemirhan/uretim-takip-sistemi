WITH base AS (
    SELECT
        gs,
        'DMY-' || lpad(gs::text, 4, '0') AS product_code,
        (array['Pleksi Levha','Metal Levha','Alüminyum Profil','Elektrik & Güç','LED Modül','Ahşap Levha','Montaj Aksesuarı','Dijital Baskı','Vinil Kaplama','Boyama Kimyasalı'])[((gs - 1) % 10) + 1] AS main_category,
        (array['levha','kg','metre','adet','paket','rol','set','litre'])[((gs - 1) % 8) + 1] AS unit_type,
        40 + ((gs * 7) % 160) AS min_qty,
        80 + ((gs * 11) % 320) AS current_qty,
        round((45 + ((gs * 13) % 450))::numeric, 2) AS unit_price,
        (array['Akrilik Market','Metalurji San.','Alutech Profil','LedPower Elektronik','BrightSign LED','Orman Ağaç Mamulleri','Montaj Pro','Dijital Baskı Center','Vinil Studio','Renk Kimya'])[((gs - 1) % 10) + 1] AS supplier_name,
        (array['Şeffaf','Opak','Anodize','IP67','6500K','Kontrplak','Paslanmaz','UV Baskı','Dış Mekan','Hızlı Kuruyan'])[((gs - 1) % 10) + 1] AS feature1,
        (array['CNC Kesim','Lazer','Taşıyıcı','Sabit Voltaj','Difüzör','Mobilya','Bağlantı','Folyo','Koruyucu','Solvent'])[((gs - 1) % 10) + 1] AS feature2
    FROM generate_series(1, 1000) AS gs
)
INSERT INTO stocks (
    product_code,
    product_name,
    category,
    unit,
    current_quantity,
    min_quantity,
    unit_price,
    currency,
    supplier_name,
    description,
    warehouse_location,
    reserved_quantity,
    on_order_quantity,
    min_stock_level,
    reorder_point,
    max_stock_level,
    group1,
    group2,
    group3,
    group4,
    category1,
    category2,
    category3,
    string1,
    string2,
    string3,
    properties1,
    properties2,
    properties3,
    properties,
    created_at,
    updated_at
)
SELECT
    b.product_code,
    b.main_category || ' ' || b.feature1 || ' Seri ' || lpad(b.gs::text, 4, '0') AS product_name,
    b.main_category,
    b.unit_type,
    b.current_qty::numeric,
    b.min_qty::numeric,
    b.unit_price,
    'TRY',
    b.supplier_name,
    b.feature1 || ' özellikli, ' || lower(b.feature2) || ' kullanımına uygun reklam ürünü' AS description,
    'Raf ' || chr(65 + ((b.gs - 1) % 6)) || (1 + ((b.gs - 1) % 10)) AS warehouse_location,
    round((b.min_qty / 4)::numeric, 3) AS reserved_quantity,
    round((20 + ((b.gs * 5) % 80))::numeric, 2) AS on_order_quantity,
    round(b.min_qty::numeric, 3) AS min_stock_level,
    round((b.min_qty + 15)::numeric, 3) AS reorder_point,
    round((b.current_qty + 120)::numeric, 3) AS max_stock_level,
    b.main_category AS group1,
    b.feature1 AS group2,
    b.feature2 AS group3,
    (array['İç Mekan','Dış Mekan','Endüstriyel','Dekoratif'])[((b.gs - 1) % 4) + 1] AS group4,
    (array['PVC','Metal','Alüminyum','Elektrik','LED','Ahşap','Montaj','Dijital','Vinil','Kimyasal'])[((b.gs - 1) % 10) + 1] AS category1,
    (array['2 mm','3 mm','5 mm','10 mm','20 mm','1.2 mm','Profil','Trafo','Modül','Set'])[((b.gs - 1) % 10) + 1] AS category2,
    (array['Şeffaf','Opak','UV Dayanımlı','Anodize','IP67','Kontrplak','Paslanmaz','Reflektif','UV Baskı','Mat'])[((b.gs - 1) % 10) + 1] AS category3,
    'SKU-' || b.product_code AS string1,
    'SER-' || substring(md5(b.product_code) from 1 for 10) AS string2,
    'LOT-' || to_char((date '2024-01-01' + ((b.gs - 1) % 180)), 'YYMMDD') AS string3,
    'Özellik: ' || b.feature1 AS properties1,
    'Kullanım: ' || b.feature2 AS properties2,
    'Tedarik: ' || b.supplier_name AS properties3,
    jsonb_build_object(
        'segment', b.main_category,
        'feature', b.feature1,
        'usage', b.feature2,
        'unit', b.unit_type,
        'supplier', b.supplier_name,
        'safety_stock', b.min_qty
    ) AS properties,
    NOW() - make_interval(days => ((b.gs - 1) % 30)) AS created_at,
    NOW() AS updated_at
FROM base b
LEFT JOIN stocks s ON s.product_code = b.product_code
WHERE s.product_code IS NULL;
